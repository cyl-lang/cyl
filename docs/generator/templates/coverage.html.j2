<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ config.site.title or 'Cyl Programming Language' }} - Code Coverage</title>
    <meta name="description" content="Code coverage reports for {{ config.site.title or 'Cyl Programming Language' }}">
    <link rel="stylesheet" href="assets/style.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="index.html" class="logo">
                    <img src="favicon.png" alt="{{ config.site.title or 'Cyl' }}" width="24" height="24">
                    <span>{{ config.site.title or 'Cyl' }}</span>
                </a>
                
                <button class="hamburger-menu" aria-label="Toggle navigation menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="nav-links">
                    {% for nav_item in config.navigation.main_nav %}
                    <a href="{{ nav_item.url }}" {% if nav_item.url == 'coverage.html' %}class="active"{% endif %}>{{ nav_item.name }}</a>
                    {% endfor %}
                </div>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="page-header">
                <h1>üìä Code Coverage</h1>
                <p>Test coverage metrics for {{ config.site.title or 'Cyl' }} codebase</p>
                {% if coverage.last_updated %}
                <div class="coverage-timestamp">
                    <span class="icon">üïí</span>
                    Last updated: {{ coverage.last_updated }}
                </div>
                {% endif %}
            </div>

            <!-- Coverage Overview -->
            <section class="coverage-overview" style="padding: 32px 0;">
                <h2 style="margin-bottom: 24px;">
                    <span class="icon">ÔøΩ</span> Coverage Summary
                </h2>
                <div class="coverage-summary" style="margin-bottom: 40px;">
                    <!-- Overall Coverage Bar Graph -->
                    <div class="coverage-bar-graph">
                        {% if coverage.typescript or coverage.rust %}
                        <div class="coverage-bar-row">
                            {% if coverage.typescript %}
                            <div class="coverage-bar-label">TypeScript</div>
                            <div class="coverage-bar-outer">
                                <div class="coverage-bar-fill" style="width: {{ coverage.typescript.overall_pct }}%; background: linear-gradient(90deg,#2563eb,#60a5fa);"></div>
                                <span class="coverage-bar-text">{{ coverage.typescript.overall_pct }}%</span>
                            </div>
                            {% endif %}
                            {% if coverage.rust %}
                            <div class="coverage-bar-label">Rust</div>
                            <div class="coverage-bar-outer">
                                <div class="coverage-bar-fill" style="width: {{ coverage.rust.overall_pct }}%; background: linear-gradient(90deg,#d97706,#fbbf24);"></div>
                                <span class="coverage-bar-text">{{ coverage.rust.overall_pct }}%</span>
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                    {% if coverage.typescript %}
                    <div class="coverage-metric">
                        <h3 style="font-size:1.15em; color:#2563eb; margin-bottom:12px;">
                            <span class="language-icon typescript">TS</span>
                            TypeScript
                        </h3>
                        <div class="coverage-metrics" style="padding: 12px 0;">
                            <div class="metric">
                                <div class="metric-label">Statements</div>
                                <div class="metric-value" style="padding-bottom: 10px;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ coverage.typescript.statements.pct }}%; background-color: {{ coverage.typescript.statements.color }}"></div>
                                    </div>
                                    <span class="percentage">{{ coverage.typescript.statements.pct }}%</span>
                                    <span class="fraction">({{ coverage.typescript.statements.covered }}/{{ coverage.typescript.statements.total }})</span>
                                </div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Branches</div>
                                <div class="metric-value" style="padding-bottom: 10px;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ coverage.typescript.branches.pct }}%; background-color: {{ coverage.typescript.branches.color }}"></div>
                                    </div>
                                    <span class="percentage">{{ coverage.typescript.branches.pct }}%</span>
                                    <span class="fraction">({{ coverage.typescript.branches.covered }}/{{ coverage.typescript.branches.total }})</span>
                                </div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Functions</div>
                                <div class="metric-value" style="padding-bottom: 10px;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ coverage.typescript.functions.pct }}%; background-color: {{ coverage.typescript.functions.color }}"></div>
                                    </div>
                                    <span class="percentage">{{ coverage.typescript.functions.pct }}%</span>
                                    <span class="fraction">({{ coverage.typescript.functions.covered }}/{{ coverage.typescript.functions.total }})</span>
                                </div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Lines</div>
                                <div class="metric-value" style="padding-bottom: 10px;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ coverage.typescript.lines.pct }}%; background-color: {{ coverage.typescript.lines.color }}"></div>
                                    </div>
                                    <span class="percentage">{{ coverage.typescript.lines.pct }}%</span>
                                    <span class="fraction">({{ coverage.typescript.lines.covered }}/{{ coverage.typescript.lines.total }})</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if coverage.rust %}
                    <div class="coverage-metric">
                        <h3 style="font-size:1.15em; color:#d97706; margin-bottom:12px;">
                            <span class="language-icon rust">ü¶Ä</span>
                            Rust
                        </h3>
                        <div class="coverage-metrics" style="padding: 12px 0;">
                            <div class="metric">
                                <div class="metric-label">Lines</div>
                                <div class="metric-value" style="padding-bottom: 10px;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ coverage.rust.lines.pct }}%; background-color: {{ coverage.rust.lines.color }}"></div>
                                    </div>
                                    <span class="percentage">{{ coverage.rust.lines.pct }}%</span>
                                    <span class="fraction">({{ coverage.rust.lines.covered }}/{{ coverage.rust.lines.total }})</span>
                                </div>
                            </div>
                            {% if coverage.rust.branches %}
                            <div class="metric">
                                <div class="metric-label">Branches</div>
                                <div class="metric-value">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ coverage.rust.branches.pct }}%; background-color: {{ coverage.rust.branches.color }}"></div>
                                    </div>
                                    <span class="percentage">{{ coverage.rust.branches.pct }}%</span>
                                    <span class="fraction">({{ coverage.rust.branches.covered }}/{{ coverage.rust.branches.total }})</span>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        <div class="coverage-details">
                            <p class="coverage-note" style="margin-top: 18px;">
                                Generated by <strong>cargo-tarpaulin</strong>
                            </p>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </section>

            <!-- File Coverage Details -->
            {% if coverage.files %}
            <section class="file-coverage">
                <h2>üìÅ File Coverage Details</h2>
                
                {% if coverage.typescript and coverage.typescript.files %}
                <div class="coverage-section">
                    <h3>
                        <span class="language-icon typescript">TS</span>
                        TypeScript Files
                    </h3>
                    <div class="file-list">
                        {% for file in coverage.typescript.files %}
                        <div class="file-item">
                            <div class="file-name">{{ file.name }}</div>
                            <div class="file-bar-graph">
                                <div class="file-bar-label">Overall</div>
                                <div class="file-bar-outer">
                                    <div class="file-bar-fill" style="width: {{ file.overall_pct }}%; background: linear-gradient(90deg,#2563eb,#60a5fa);"></div>
                                    <span class="file-bar-text">{{ file.overall_pct }}%</span>
                                </div>
                            </div>
                            <div class="file-coverage-bars">
                                <div class="coverage-mini-bar statements" title="Statements: {{ file.statements.pct }}%">
                                    <div class="progress-fill" style="width: {{ file.statements.pct }}%; background-color: {{ file.statements.color }}"></div>
                                </div>
                                <div class="coverage-mini-bar branches" title="Branches: {{ file.branches.pct }}%">
                                    <div class="progress-fill" style="width: {{ file.branches.pct }}%; background-color: {{ file.branches.color }}"></div>
                                </div>
                                <div class="coverage-mini-bar functions" title="Functions: {{ file.functions.pct }}%">
                                    <div class="progress-fill" style="width: {{ file.functions.pct }}%; background-color: {{ file.functions.color }}"></div>
                                </div>
                                <div class="coverage-mini-bar lines" title="Lines: {{ file.lines.pct }}%;">
                                    <div class="progress-fill" style="width: {{ file.lines.pct }}%; background-color: {{ file.lines.color }}"></div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                {% if coverage.rust and coverage.rust.files %}
                <div class="coverage-section">
                    <h3>
                        <span class="language-icon rust">ü¶Ä</span>
                        Rust Files
                    </h3>
                    <div class="file-list">
                        {% for file in coverage.rust.files %}
                        <div class="file-item">
                            <div class="file-name">{{ file.name }}</div>
                            <div class="file-bar-graph">
                                <div class="file-bar-label">Overall</div>
                                <div class="file-bar-outer">
                                    <div class="file-bar-fill" style="width: {{ file.lines.pct }}%; background: linear-gradient(90deg,#d97706,#fbbf24);"></div>
                                    <span class="file-bar-text">{{ file.lines.pct }}%</span>
                                </div>
                            </div>
                            <div class="file-coverage-bars">
                                <div class="coverage-mini-bar lines" title="Lines: {{ file.lines.pct }}%">
                                    <div class="progress-fill" style="width: {{ file.lines.pct }}%; background-color: {{ file.lines.color }}"></div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </section>
            {% endif %}

            <!-- Coverage Trends -->
            {% if coverage.trends %}
            <section class="coverage-trends">
                <h2>üìà Coverage Trends</h2>
                <div class="trend-chart">
                    <p class="feature-note">üìä Coverage trend visualization coming soon...</p>
                </div>
            </section>
            {% endif %}

            <!-- Links to Detailed Reports -->
            <section class="detailed-reports">
                <h2>üîç Detailed Reports</h2>
                <div class="report-links">
                    {% if coverage.typescript %}
                    <a href="coverage/lcov-report/index.html" class="report-link" target="_blank">
                        <div class="report-icon">üìä</div>
                        <div class="report-content">
                            <h3>TypeScript Coverage Report</h3>
                            <p>Interactive HTML coverage report with line-by-line details</p>
                        </div>
                    </a>
                    {% endif %}
                    
                    {% if coverage.rust %}
                    <a href="coverage/index.html" class="report-link" target="_blank">
                        <div class="report-icon">ü¶Ä</div>
                        <div class="report-content">
                            <h3>Rust Coverage Report</h3>
                            <p>Detailed Rust code coverage generated by cargo-tarpaulin</p>
                        </div>
                    </a>
                    {% endif %}
                </div>
            </section>

            <!-- Coverage Configuration -->
            <section class="coverage-config">
                <h2>‚öôÔ∏è Coverage Configuration</h2>
                <div class="config-info">
                    <div class="config-item">
                        <h3>TypeScript Coverage</h3>
                        <ul>
                            <li><strong>Tool:</strong> Jest with Istanbul</li>
                            <li><strong>Command:</strong> <code>npm run test:coverage</code></li>
                            <li><strong>Threshold:</strong> 80% overall coverage target</li>
                            <li><strong>Formats:</strong> HTML, LCOV, JSON</li>
                        </ul>
                    </div>
                    <div class="config-item">
                        <h3>Rust Coverage</h3>
                        <ul>
                            <li><strong>Tool:</strong> cargo-tarpaulin</li>
                            <li><strong>Command:</strong> <code>npm run test:coverage:rust</code></li>
                            <li><strong>Formats:</strong> XML (Cobertura), HTML</li>
                            <li><strong>Target:</strong> compiler/ directory</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>{{ config.footer.copyright or '&copy; 2025 Cyl Programming Language' }}</p>
                
                {% if config.footer.links %}
                <div class="footer-links">
                    {% for link in config.footer.links %}
                    <a href="{{ link.url }}" class="footer-link">
                        {% if link.icon %}
                        <svg class="icon icon-{{ link.icon }}" width="16" height="16">
                            <use href="#icon-{{ link.icon }}"></use>
                        </svg>
                        {% endif %}
                        {{ link.name }}
                    </a>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if config.footer.license %}
                <div class="footer-license">
                    <a href="{{ config.footer.license.url }}" class="license-link">
                        <svg class="icon icon-scale" width="14" height="14">
                            <use href="#icon-scale"></use>
                        </svg>
                        {{ config.footer.license.name }}
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </footer>

    <!-- SVG Icon Definitions -->
    <svg style="display: none;">
        <defs>
            <!-- Navigation Icons -->
            <symbol id="icon-github" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
            </symbol>
            <symbol id="icon-external-link" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15,3 21,3 21,9"/>
                <line x1="10" y1="14" x2="21" y2="3"/>
            </symbol>
            <symbol id="icon-scale" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 11c0 2.21-1.79 4-4 4s-4-1.79-4-4 1.79-4 4-4 4 1.79 4 4z"/>
                <path d="M12 2v7.5"/>
                <path d="M12 14.5V22"/>
                <path d="M4.93 4.93l4.24 4.24"/>
                <path d="M14.83 14.83l4.24 4.24"/>
                <path d="M2 12h7.5"/>
                <path d="M14.5 12H22"/>
                <path d="M4.93 19.07l4.24-4.24"/>
                <path d="M14.83 9.17l4.24-4.24"/>
            </symbol>
            <symbol id="icon-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="6" x2="21" y2="6"/>
                <line x1="3" y1="12" x2="21" y2="12"/>
                <line x1="3" y1="18" x2="21" y2="18"/>
            </symbol>
        </defs>
    </svg>

    <script src="assets/script.js"></script>
</body>
</html>
